<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <title>Vape Shop</title>
    <style>
        :root {
            --tg-theme-bg-color: #1a1a1a;
            --tg-theme-text-color: #e0e0e0;
            --tg-theme-hint-color: #9e9e9e;
            --tg-theme-link-color: #81d4fa;
            --tg-theme-button-color: #4fc3f7;
            --tg-theme-button-text-color: #ffffff;
            --tg-theme-secondary-bg-color: #2c2c2c;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background-color: var(--tg-theme-bg-color);
            color: var(--tg-theme-text-color);
            margin: 0;
            padding: 20px;
            display: flex;
            flex-direction: column;
            align-items: center;
            min-height: 100vh; /* –ó–∞–Ω–∏–º–∞–µ—Ç –≤—Å—é –≤—ã—Å–æ—Ç—É */
            box-sizing: border-box;
            overflow-x: hidden;
        }

        .container {
            width: 100%;
            max-width: 400px;
            margin: auto; /* –¶–µ–Ω—Ç—Ä–∏—Ä—É–µ–º */
            padding-bottom: 80px; /* –ú–µ—Å—Ç–æ –¥–ª—è MainButton */
        }

        h1 {
            text-align: center;
            color: var(--tg-theme-link-color);
            margin-bottom: 30px;
            font-size: 2em;
            text-shadow: 0 0 8px rgba(79, 195, 247, 0.4);
        }

        .card {
            background-color: rgba(44, 44, 44, 0.7); /* –ü—Ä–æ–∑—Ä–∞—á–Ω–∞—è –ø–ª–∞—à–∫–∞ */
            border-radius: 15px;
            padding: 20px;
            margin-bottom: 15px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.3);
            border: 1px solid rgba(79, 195, 247, 0.2); /* –¢–æ–Ω–∫–∞—è —Ä–∞–º–∫–∞ */
            transition: all 0.3s ease;
            cursor: pointer;
        }

        .card:hover {
            transform: translateY(-3px);
            box-shadow: 0 6px 20px rgba(0, 0, 0, 0.4);
        }

        .card.active {
            background-color: rgba(79, 195, 247, 0.15); /* –ê–∫—Ç–∏–≤–Ω—ã–π —Ñ–æ–Ω */
            border-color: var(--tg-theme-link-color);
        }

        .card h2 {
            margin-top: 0;
            color: var(--tg-theme-text-color);
            font-size: 1.5em;
        }

        .flavor-options {
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.5s ease-out, opacity 0.5s ease-out;
            opacity: 0;
        }

        .card.active .flavor-options {
            max-height: 500px; /* –î–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –¥–ª—è –ø–æ–∫–∞–∑–∞ –≤—Å–µ—Ö –≤–∫—É—Å–æ–≤ */
            opacity: 1;
        }

        .flavor-button {
            background-color: var(--tg-theme-secondary-bg-color);
            color: var(--tg-theme-text-color);
            border: 1px solid rgba(255, 255, 255, 0.1);
            padding: 10px 15px;
            border-radius: 10px;
            margin: 5px;
            cursor: pointer;
            transition: all 0.2s ease;
            display: inline-block;
            font-size: 0.9em;
        }

        .flavor-button:hover {
            background-color: var(--tg-theme-button-color);
        }

        .flavor-button.selected {
            background-color: var(--tg-theme-link-color);
            color: var(--tg-theme-button-text-color);
            border-color: var(--tg-theme-link-color);
        }

        .cart-summary {
            background-color: rgba(44, 44, 44, 0.8);
            border-radius: 10px;
            padding: 15px;
            margin-top: 20px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.2);
            font-size: 0.9em;
            display: none; /* –°–∫—Ä—ã—Ç–æ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é */
        }
        .cart-summary.visible {
            display: block;
        }
        .cart-item {
            display: flex;
            justify-content: space-between;
            margin-bottom: 5px;
        }
        .cart-item span:first-child {
            color: var(--tg-theme-hint-color);
        }
        .total-price {
            font-weight: bold;
            color: var(--tg-theme-link-color);
            margin-top: 10px;
            text-align: right;
            font-size: 1.1em;
        }

    </style>
</head>
<body>
    <div class="container">
        <h1>VAPE SHOP üí®</h1>

        <div class="card" data-model="Vaka 20k" data-price="15000">
            <h2>Vaka 20K</h2>
            <div class="flavor-options">
                <button class="flavor-button" data-flavor="–í–∏–Ω–æ–≥—Ä–∞–¥">üçá –í–∏–Ω–æ–≥—Ä–∞–¥ (15 000 ‚Ç∏)</button>
                <button class="flavor-button" data-flavor="–ú–∞–Ω–≥–æ">ü•≠ –ú–∞–Ω–≥–æ (15 000 ‚Ç∏)</button>
                <button class="flavor-button" data-flavor="–ê—Ä–±—É–∑">üçâ –ê—Ä–±—É–∑ (15 000 ‚Ç∏)</button>
            </div>
        </div>

        <div class="card" data-model="Vaka 30k" data-price="19000">
            <h2>Vaka 30K</h2>
            <div class="flavor-options">
                <button class="flavor-button" data-flavor="–ß–µ—Ä–Ω–∏–∫–∞">ü´ê –ß–µ—Ä–Ω–∏–∫–∞ (19 000 ‚Ç∏)</button>
                <button class="flavor-button" data-flavor="–ö–æ–ª–∞">ü•§ –ö–æ–ª–∞ (19 000 ‚Ç∏)</button>
                <button class="flavor-button" data-flavor="–õ—ë–¥">üßä –õ—ë–¥ (19 000 ‚Ç∏)</button>
            </div>
        </div>

        <div class="card" data-model="Vaka 52k" data-price="25000">
            <h2>Vaka 52K</h2>
            <div class="flavor-options">
                <button class="flavor-button" data-flavor="–ö–ª—É–±–Ω–∏–∫–∞">üçì –ö–ª—É–±–Ω–∏–∫–∞ (25 000 ‚Ç∏)</button>
                <button class="flavor-button" data-flavor="–ë–∞–Ω–∞–Ω">üçå –ë–∞–Ω–∞–Ω (25 000 ‚Ç∏)</button>
                <button class="flavor-button" data-flavor="–≠–Ω–µ—Ä–≥–µ—Ç–∏–∫">‚ö° –≠–Ω–µ—Ä–≥–µ—Ç–∏–∫ (25 000 ‚Ç∏)</button>
            </div>
        </div>

        <div id="cart-summary" class="cart-summary">
            <h3>–í–∞—à –∑–∞–∫–∞–∑:</h3>
            <div id="cart-items"></div>
            <div class="total-price">–ò—Ç–æ–≥–æ: <span id="total-amount">0</span> ‚Ç∏</div>
        </div>

    </div>

    <script>
        let tg = window.Telegram.WebApp;
        tg.expand();
        tg.MainButton.setText("–û—Ñ–æ—Ä–º–∏—Ç—å –∑–∞–∫–∞–∑");
        tg.MainButton.setParams({
            textColor: tg.themeParams.button_text_color || '#ffffff',
            color: tg.themeParams.button_color || '#4fc3f7'
        });

        const models = {
            "Vaka 20k": { price: 15000, flavors: ["–í–∏–Ω–æ–≥—Ä–∞–¥", "–ú–∞–Ω–≥–æ", "–ê—Ä–±—É–∑"] },
            "Vaka 30k": { price: 19000, flavors: ["–ß–µ—Ä–Ω–∏–∫–∞", "–ö–æ–ª–∞", "–õ—ë–¥"] },
            "Vaka 52k": { price: 25000, flavors: ["–ö–ª—É–±–Ω–∏–∫–∞", "–ë–∞–Ω–∞–Ω", "–≠–Ω–µ—Ä–≥–µ—Ç–∏–∫"] }
        };

        let cart = [];

        function updateMainButton() {
            if (cart.length > 0) {
                const total = cart.reduce((sum, item) => sum + item.price, 0);
                tg.MainButton.setText(`–û—Ñ–æ—Ä–º–∏—Ç—å –∑–∞–∫–∞–∑ –Ω–∞ ${total} ‚Ç∏`);
                tg.MainButton.show();
            } else {
                tg.MainButton.hide();
            }
        }

        function updateCartSummary() {
            const cartItemsContainer = document.getElementById('cart-items');
            const totalAmountSpan = document.getElementById('total-amount');
            const cartSummary = document.getElementById('cart-summary');

            cartItemsContainer.innerHTML = '';
            let total = 0;

            if (cart.length === 0) {
                cartSummary.classList.remove('visible');
                return;
            }

            cart.forEach(item => {
                const div = document.createElement('div');
                div.classList.add('cart-item');
                div.innerHTML = `
                    <span>${item.model} (${item.flavor})</span>
                    <span>${item.price} ‚Ç∏ <button onclick="removeFromCart('${item.id}')" style="background: none; border: none; color: #ff5252; cursor: pointer; font-size: 1.2em;">&times;</button></span>
                `;
                cartItemsContainer.appendChild(div);
                total += item.price;
            });

            totalAmountSpan.textContent = total.toLocaleString();
            cartSummary.classList.add('visible');
            updateMainButton();
        }

        function addToCart(model, flavor, price) {
            const id = Date.now().toString(); // –£–Ω–∏–∫–∞–ª—å–Ω—ã–π ID –¥–ª—è —É–¥–∞–ª–µ–Ω–∏—è
            cart.push({ id, model, flavor, price });
            updateCartSummary();
        }

        function removeFromCart(idToRemove) {
            cart = cart.filter(item => item.id !== idToRemove);
            updateCartSummary();
        }

        document.querySelectorAll('.card').forEach(card => {
            card.addEventListener('click', function() {
                // –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ –∞–∫—Ç–∏–≤–Ω–æ–≥–æ —Å–æ—Å—Ç–æ—è–Ω–∏—è
                const isActive = this.classList.contains('active');
                document.querySelectorAll('.card').forEach(c => c.classList.remove('active'));
                if (!isActive) {
                    this.classList.add('active');
                }
            });
        });

        document.querySelectorAll('.flavor-button').forEach(button => {
            button.addEventListener('click', function(event) {
                event.stopPropagation(); // –ü—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–∞–µ–º –∑–∞–∫—Ä—ã—Ç–∏–µ –ø—Ä–∏ –Ω–∞–∂–∞—Ç–∏–∏ –Ω–∞ –≤–∫—É—Å
                const model = this.closest('.card').dataset.model;
                const flavor = this.dataset.flavor;
                const price = parseInt(this.closest('.card').dataset.price);

                addToCart(model, flavor, price);
            });
        });

        tg.onEvent('mainButtonClicked', function() {
            if (cart.length > 0) {
                tg.sendData(JSON.stringify({
                    items: cart,
                    total: cart.reduce((sum, item) => sum + item.price, 0)
                }));
                tg.close();
            }
        });

        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è
        updateMainButton(); // –°–∫—Ä—ã—Ç—å –∫–Ω–æ–ø–∫—É –ø—Ä–∏ —Å—Ç–∞—Ä—Ç–µ, –µ—Å–ª–∏ –∫–æ—Ä–∑–∏–Ω–∞ –ø—É—Å—Ç–∞
    </script>
</body>
</html>